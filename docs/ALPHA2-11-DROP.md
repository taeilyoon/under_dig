# Alpha-2-11: 아이템 드롭 로직 설계 (Item Drop Logic Design)

## 목표
- 상자(Chest)를 열거나 특정 조건을 만족했을 때 아이템이 드롭되는 확률과 풀(Pool) 구성을 정의합니다.
- 스테이지 진행도에 따라 아이템의 희귀도와 품질이 자연스럽게 상승하도록 설계합니다.

## 드롭 소스 (Drop Sources)
1. **보물 상자 (Chest)**: 맵 곳곳에 배치되며, 확정적으로 1~2개의 아이템을 드롭합니다.
2. **적 처치 (Enemy Drop)**: 정예 적이나 보스 처치 시 높은 확률로 희귀 아이템을 드롭합니다. (일반 적은 매우 낮은 확률)

## 희귀도 시스템 (Rarity System)
- **Common (일반)**: 가장 흔하며 기본 기능에 충실함 (예: 하급 포션).
- **Rare (희귀)**: 유용한 버프나 강력한 효과를 가짐 (예: 공격력 주문서).
- **Legendary (전설)**: 전황을 뒤집을 수 있는 강력한 효과 (예: 전체 섬멸 주문서).

## 드롭 확률 및 가중치 (Probability Weights)
| 스테이지 구간 | Common | Rare | Legendary |
| :--- | :--- | :--- | :--- |
| **Stage 1-5** | 80% | 18% | 2% |
| **Stage 6-10** | 60% | 35% | 5% |
| **Stage 11+** | 40% | 45% | 15% |

## 스테이지 스케일링 (Stage Scaling)
- `stageProgress`가 증가할수록 고정 가중치 대신 함수형 가중치를 적용합니다.
- `rarity_weight = base_weight + (stageProgress * scaling_factor)`

## 구현 계획
- `lib/drop/drop_table.dart`: 희귀도별 아이템 리스트와 가중치 계산 로직을 관리합니다.
- `DropManager`: 현재 스테이지와 플레이어 상태를 기반으로 최종 드롭 아이템을 결정하는 싱글톤 객체입니다.

## 향후 작업
- **Alpha-2-12**: 드롭된 아이템을 실제로 사용했을 때 발생하는 효과 구현.
- **Alpha-2-14**: 스폰 컨트롤러와 드롭 시스템의 완전한 통합.
